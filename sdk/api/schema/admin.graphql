query ListCampaigns($org: String!) {
  org(name: $org) {
    campaigns {
      ...campaignFields
      ...campaignPrivateFields
      org {
        ...orgIds
      }
    }
  }
}

query ListActionPages($org: String!) {
  org(name: $org) {
    actionPages {
      ...actionPageFields
      ...actionPagePrivateFields
      campaign {
        ...campaignIds
      }
    }
  }
}

query GetCampaign($org: String!, $id: Int!) {
  org(name: $org) {
    campaign(id: $id) {
      ...campaignFields
      ...campaignPrivateFields
      ...campaignStats
      org {
        ...orgIds
      }
      ...campaignPartnerships
    }
  }
}

query FindPublicCampaign($name: String, $title: String) {
  campaigns(title: $title, name: $name) {
    ...campaignFields
    org {
      ...orgIds
    }
  }
}

query GetActionPage($org: String!, $id: Int, $name: String) {
  org(name: $org) {
    name
    title
    actionPage(id: $id, name: $name) {
      ...actionPageFields
      ...actionPagePrivateFields
      campaign {
        ...campaignFields
        ...campaignPrivateFields
      }
    }
  }
}

query ListActionPagesByCampaign($org: String!, $campaignId: Int!) {
  org(name: $org) {
    name
    title
    actionPages(select: { campaignId: $campaignId }) {
      ...actionPageFields
      ...actionPagePrivateFields
      campaign {
        ...campaignFields
      }
    }
  }
}

query ExportCampaignActions(
  $org: String!
  $campaignId: Int
  $campaignName: String
  $start: Int
  $after: DateTime
  $limit: Int
  $onlyOptIn: Boolean
) {
  exportActions(
    orgName: $org
    campaignId: $campaignId
    campaignName: $campaignName
    start: $start
    after: $after
    limit: $limit
    onlyOptIn: $onlyOptIn
  ) {
    ...actionExport
    actionPage {
      ...actionPageIds
    }
  }
}

query ExportOrgActions(
  $org: String!
  $start: Int
  $after: DateTime
  $limit: Int
  $onlyOptIn: Boolean
) {
  exportActions(
    orgName: $org
    start: $start
    after: $after
    limit: $limit
    onlyOptIn: $onlyOptIn
  ) {
    ...actionExport
    actionPage {
      ...actionPageIds
    }
    campaign {
      ...campaignExportIds
    }
  }
}

mutation UpdateActionPage($id: Int!, $actionPage: ActionPageInput!) {
  updateActionPage(id: $id, input: $actionPage) {
    id
  }
}

mutation CopyActionPage($fromName: String!, $toOrg: String!, $toName: String!) {
  copyActionPage(fromName: $fromName, name: $toName, orgName: $toOrg) {
    ...actionPageFields
    ...actionPagePrivateFields
    campaign {
      ...campaignFields
    }
  }
}

mutation CopyCampaignActionPage(
  $fromCampaign: String!
  $toOrg: String!
  $toName: String!
) {
  copyCampaignActionPage(
    fromCampaignName: $fromCampaign
    name: $toName
    orgName: $toOrg
  ) {
    ...actionPageFields
    ...actionPagePrivateFields
    campaign {
      id
      name
      title
      externalId
    }
  }
}

mutation JoinOrg($orgName: String!) {
  joinOrg(name: $orgName) {
    status
  }
}

mutation UpsertCampaign($org: String!, $campaign: CampaignInput!) {
  upsertCampaign(orgName: $org, input: $campaign) {
    id
  }
}

query ListKeys($org: String!) {
  org(name: $org) {
    keys {
      ...keyFields
    }
  }
}

mutation GenerateKey($org: String!, $input: GenKeyInput!) {
  generateKey(orgName: $org, input: $input) {
    id
    name
    public
    private
    active
    expired
    expiredAt
  }
}

mutation AddKey($org: String!, $input: AddKeyInput!) {
  addKey(orgName: $org, input: $input) {
    id
    name
    public
    active
    expired
    expiredAt
  }
}

mutation ActivateKey($org: String!, $id: Int!) {
  activateKey(orgName: $org, id: $id) {
    status
  }
}

mutation AddOrg($org: OrgInput!) {
  addOrg(input: $org) {
    ...orgIds
  }
}

mutation UpdateOrg($orgName: String!, $org: OrgInput!) {
  updateOrg(name: $orgName, input: $org) {
    ...orgFields
    ...orgPrivateFields
  }
}

subscription ActionPageUpserted($org: String) {
  actionPageUpserted(orgName: $org) {
    ...actionPageFields
    ...actionPagePrivateFields
    campaign {
      ...campaignIds
    }
    org {
      ...orgIds
    }
  }
}

# Dashboard queries

query CurrentUserOrgs {
  currentUser {
    id
    email
    roles {
      role
      org {
        ...orgIds
      }
    }
  }
}

# Deprecate
query DashOrgOverview($org: String!) {
  org(name: $org) {
    name
    title
    ...orgPrivateFields
    ... on PrivateOrg {
      campaigns {
        ...campaignFields
        ...campaignStats
        org {
          ...orgIds
        }
      }
    }
  }
}

# Get main org data
# (could include service status?)
#
query GetOrg($org: String!) {
  org(name: $org) {
    ...orgFields
    ...orgPrivateFields
    keys(select: { active: true }) {
      ...keyFields
    }
    services {
      ...serviceFields
    }
  }
}

query GetOrgAttrs($org: String!) {
  org(name: $org) {
    ...orgFields
    ...orgPrivateFields
  }
}
